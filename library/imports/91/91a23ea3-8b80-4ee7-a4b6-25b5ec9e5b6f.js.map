{"version":3,"sources":["assets/script/recharge/RechargePayView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { EventApi } from \"../framework/event/EventApi\";\nimport UIView from \"../framework/ui/UIView\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class RechargePayView extends UIView {\n\n    @property(cc.Sprite)\n    private imgWebViewBG: cc.Sprite = null;\n\n    @property(cc.WebView)\n    private wbvPayPage: cc.WebView = null;\n\n    @property(cc.Node)\n    private nodError: cc.Node = null;\n\n    @property(cc.Sprite)\n    private imgLoading: cc.Sprite = null;\n\n    // 支付地址 URL\n    private m_url: string = null;\n    // 加载转动动画\n    private m_animLoading: cc.Tween = null;\n\n    public static getPrefabUrl() {\n        return \"recharge/prefabs/RechargePayView\";\n    }\n\n    bindingEvents() {\n        this.registerEvent(EventApi.NetEvent.ON_CLOSE, () => {\n            this.hideLoading();\n            this.hideWebViewBG();\n            this.hideWebView();\n            this.showError();\n        });\n\n        this.wbvPayPage.node.on('loaded', () => {\n            this.hideLoading();\n            this.hideError();\n            this.showWebView();\n            this.showWebViewBG();\n        })\n        this.wbvPayPage.node.on(\"error\", () => {\n            this.showError();\n        });\n        this.wbvPayPage.node.on(\"loading\", () => {\n            this.showLoading();\n        });\n\n        this.registerEvent(\"updateUserInfo\", ()=>{\n            this.onClickClose()\n        });\n    }\n\n    onLoad() {\n        super.onLoad();\n\n        this.initView();\n        this.content = this.node.getChildByName('imgBg');\n    }\n\n    start() {\n\n    }\n\n    private initView(): void {\n        this.hideLoading();\n        this.hideWebViewBG();\n        // this.hideWebView();\n        this.hideError();\n    }\n\n    private showLoading(): void {\n        if (this.m_animLoading) {\n            this.m_animLoading.stop();\n            this.m_animLoading = null;\n        }\n\n        this.m_animLoading = cc.tween(this.imgLoading.node)\n            .by(2, { angle: -360 })\n            .repeatForever()\n            .start();\n        this.imgLoading.node.active = true;\n    }\n\n    private hideLoading(): void {\n        if (this.m_animLoading) {\n            this.m_animLoading.stop();\n        }\n        this.m_animLoading = null;\n        this.imgLoading.node.active = false;\n    }\n\n    private showWebViewBG(): void {\n        this.imgWebViewBG.node.active = true;\n    }\n\n    private hideWebViewBG(): void {\n        this.imgWebViewBG.node.active = false;\n    }\n\n    private showWebView(): void {\n        this.wbvPayPage.node.active = true;\n    }\n\n    private hideWebView(): void {\n        this.wbvPayPage.node.active = false;\n    }\n\n    private showError(): void {\n        this.nodError.active = true;\n    }\n\n    private hideError(): void {\n        this.nodError.active = false;\n    }\n\n    show(args) {\n        super.show(args);\n        this.showWithAction(true);\n\n        this.m_url = args[0];\n\n        G.Logger.log(\"支付网址：\", this.m_url);\n\n        this.wbvPayPage.url = this.m_url;\n    }\n\n    private onClickRetry(): void { \n        this.wbvPayPage.url = \"\";\n        this.wbvPayPage.url = this.m_url;\n    }\n\n    private onClickClose(): void {\n        this.hideWebView();\n        this.hideWebViewBG();\n        this.closeWithAction();\n    }\n\n    // update (dt) {}\n}\n"]}