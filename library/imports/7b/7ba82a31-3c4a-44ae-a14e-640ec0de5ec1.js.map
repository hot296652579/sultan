{"version":3,"sources":["assets/games/crash/script/view/CrashEscapeItemNode.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { UtilMgr } from \"../../../../script/global/UtilMgr\";\n\nconst ACTION_TIME: number = 3;\nconst FLY_X: number = 100;\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class CrashEscapeItemNode extends cc.Component {\n\n    private m_nick: string = null;\n    private m_rate: number = null;\n    private m_originPos: cc.Vec2 = null;\n    private m_tween: cc.Tween = null;\n\n    onLoad() {\n        this.node.getComponent(cc.Label).string = \"\";\n    }\n\n    start() {\n\n    }\n\n    onEnable() {\n        this.setView();\n    }\n\n    public setOriginPos(pos: cc.Vec2): void {\n        this.node.setPosition(pos);\n        this.m_originPos = pos;\n    }\n\n    public setData(nick: string, rate: number): void {\n        this.m_nick = nick;\n        this.m_rate = rate;\n    }\n\n    public setView(): void {\n        // this.node.getComponent(cc.Label).string = `● ${this.m_nick}@${UtilMgr.toFixed(this.m_rate / 100, 2)}x`;\n        this.node.getComponent(cc.Label).string = `${this.m_nick}@${UtilMgr.toFixed(this.m_rate / 100, 2)}x`;\n    }\n\n    public clear(): void {\n        this.m_nick = null;\n        this.m_rate = null;\n        this.m_originPos = null;\n        this.stopAnim();\n    }\n\n    public runDrop(completeCallback?: Function): void {\n        this.setView();\n        this.stopAnim();\n\n        this.m_tween = cc.tween(this.node)\n            .to(ACTION_TIME, { y: 0, opacity: 50 })\n            .call(() => {\n                this.stopAnim();\n                completeCallback && completeCallback();\n            })\n            .start();\n    }\n\n    public runFly(completeCallback?: Function): void {\n        this.setView();\n        this.stopAnim();\n\n        let residuePercent: number = this.node.y / this.m_originPos.y;\n        let residueTime: number = UtilMgr.toFixed(ACTION_TIME * residuePercent, 2);\n        let residueX: number = UtilMgr.toFixed(FLY_X * residuePercent, 2);\n\n        if (this.node.y > this.m_originPos.y) {\n            this.node.y = this.m_originPos.y;\n        }\n\n        let x: number = this.m_originPos.x - residueX;\n        if (x < 0) {\n            x = 0;\n        }\n\n        this.m_tween = cc.tween(this.node)\n            .to(residueTime, { x: x, y: 0, opacity: 50 })\n            .call(() => {\n                this.stopAnim();\n                completeCallback && completeCallback();\n            })\n            .start();\n    }\n\n    public stopAnim(): void {\n        if (this.m_tween) {\n            this.m_tween.stop();\n            this.m_tween = null;\n        }\n    }\n\n    // update (dt) {}\n}\n"]}