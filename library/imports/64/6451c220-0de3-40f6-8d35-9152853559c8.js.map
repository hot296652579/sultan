{"version":3,"sources":["assets/script/framework/base/AudioComponent.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import UIView from \"../ui/UIView\";\nimport { ResourceInfo, BUNDLE_TYPE } from \"./Defines\";\nimport { Manager } from \"../Framework\";\n\n/**\n * @description 声音组件\n */\nconst { ccclass, property, menu } = cc._decorator;\n\n/**@description 框架内部使用，外部请不要调用 */\nclass AudioData {\n    private static _instance: AudioData = null;\n    public static get instance() {\n        if (this._instance == null) {\n            this._instance = new AudioData();\n            this._instance.init();\n        }\n        return this._instance;\n    }\n    public musicVolume = 100;\n    public effectVolume = 100;\n    public isEffectOn = true;\n    public isMusicOn = true;\n    public curMusicUrl = \"\";\n    public curEffectId = -1;\n    public curBundle: BUNDLE_TYPE = null;\n\n    private readonly _storeMusicKey: string = \"default_save_music\";\n    private readonly _storeEffectKey: string = \"default_save_effect\";\n    private readonly _storeMusicVolumeKey: string = \"default_save_music_volume_key\";\n    private readonly _storeEffectVolumeKey: string = \"default_save_effect_volume_key\";\n\n    private init() {\n\n        //音量开关读取\n        this.isMusicOn = Manager.localStorage.getItem(this._storeMusicKey, this.isMusicOn);\n        this.isEffectOn = Manager.localStorage.getItem(this._storeEffectKey, this.isEffectOn);\n\n        //音量读取\n        this.musicVolume = Manager.localStorage.getItem(this._storeMusicVolumeKey, this.musicVolume);\n        this.effectVolume = Manager.localStorage.getItem(this._storeEffectVolumeKey, this.effectVolume);\n    }\n\n    /**@description 存储 */\n    public save() {\n        try {\n            Manager.localStorage.setItem(this._storeMusicKey, this.isMusicOn);\n            Manager.localStorage.setItem(this._storeMusicVolumeKey, this.musicVolume);\n\n            Manager.localStorage.setItem(this._storeEffectKey, this.isEffectOn);\n            Manager.localStorage.setItem(this._storeEffectVolumeKey, this.effectVolume);\n        } catch (error) {\n        }\n    }\n}\n\n@ccclass\n@menu(\"framework/base/AudioComponent\")\nexport default class AudioComponent extends cc.Component {\n\n    protected audioData = AudioData.instance;\n\n    /**@description 音频控件资源拥有者，该对象由UIManager打开的界面 */\n    public owner: UIView = null;\n\n    private effectMap: Map<string, number> = new Map();\n\n    /**@description 背景音乐音量 */\n    public get musicVolume() { return this.audioData.musicVolume; }\n    public set musicVolume(volume) {\n        let value = volume / 100;\n        cc.audioEngine.setMusicVolume(value);\n        if (volume <= 0) {\n            this.stopMusic();\n        }\n        this.audioData.musicVolume = volume;\n    };\n    /**@description 音效音量 */\n    public get effectVolume() { return this.audioData.effectVolume; }\n    public set effectVolume(volume) {\n        let value = volume / 100;\n        cc.audioEngine.setEffectsVolume(value);\n        if (volume <= 0) {\n            this.stopEffect();\n        }\n        this.audioData.effectVolume = volume;\n    };\n\n    /**@description 音效开关 */\n    public get isEffectOn() { return this.audioData.isEffectOn; }\n    public set isEffectOn(value) {\n        this.audioData.isEffectOn = value;\n        this.save();\n        if (!value) {\n            this.stopEffect();\n        }\n    };\n\n    /**@description 背景音乐开关 */\n    public get isMusicOn() { return this.audioData.isMusicOn; }\n    /**@description 设置背景音乐开关 */\n    public setMusicEnabled(isOn: boolean, isPlay: boolean = true) {\n        this.audioData.isMusicOn = isOn;\n        this.save();\n        if (this.audioData.isMusicOn) {\n            if (!this.curMusicUrl) {\n                return;\n            }\n            if (isPlay) {\n                this.playMusic(this.curMusicUrl, this.curBundle, true);\n            }\n        } else {\n            this.stopMusic();\n        }\n    };\n    /**@description 当前播放的背景音乐 */\n    public get curMusicUrl() { return this.audioData.curMusicUrl; }\n    public set curMusicUrl(value) { this.audioData.curMusicUrl = value };\n\n    public get curBundle() { return this.audioData.curBundle; }\n    public set curBundle(value) { this.audioData.curBundle = value; }\n\n    /**@description 存储 */\n    public save() {\n        this.audioData.save();\n    }\n\n    /**@description 停止 */\n    public stopEffect(effectId: number = null) {\n        if (effectId == null) {\n            if (this.audioData.curEffectId < 0) {\n                return;\n            }\n            cc.audioEngine.stopEffect(this.audioData.curEffectId);\n            this.audioData.curEffectId = -1;\n        }\n        else {\n            cc.audioEngine.stopEffect(effectId);\n        }\n    }\n\n    public stopEffectByPath(path: string) {\n        let id: number = this.effectMap.get(path);\n        if (id !== null && id !== undefined) {\n            this.stopEffect(id);\n            this.effectMap.delete(path);\n        }\n    }\n\n    public stopAllEffects() {\n        this.effectMap.clear();\n        cc.audioEngine.stopAllEffects();\n    }\n\n    public stopMusic() {\n        cc.audioEngine.stopMusic();\n    }\n\n    public playMusic(url: string, bundle: BUNDLE_TYPE, loop: boolean = true, retain = false) {\n        return new Promise<{ url: string, isSuccess: boolean }>((resolve) => {\n            if (CC_DEBUG) {\n                if (!this.owner) {\n                    cc.error(`必须要指定资源的管理都才能播放`);\n                    resolve({ url: url, isSuccess: false });\n                    return;\n                }\n            }\n            this.audioData.curMusicUrl = url;\n            this.audioData.curBundle = bundle;\n            if (this.audioData.isMusicOn) {\n                Manager.cacheManager.getCacheByAsync(url, cc.AudioClip, bundle).then((data) => {\n                    if (data && this.owner) {\n                        let info = new ResourceInfo;\n                        info.url = url;\n                        info.type = cc.AudioClip;\n                        info.data = data;\n                        info.bundle = bundle;\n                        if (!retain) {\n                            if (this.owner) {\n                                Manager.uiManager.addLocal(info, this.owner.className);\n                            } else {\n                                Manager.uiManager.garbage.addLocal(info);\n                            }\n                        }\n\n                        //停掉当前播放音乐\n                        this.stopMusic();\n                        //播放新的背景音乐\n                        cc.audioEngine.playMusic(data, loop);\n                        resolve({ url: url, isSuccess: true });\n                    } else {\n                        resolve({ url: url, isSuccess: false });\n                    }\n                });\n            }\n        });\n\n    }\n\n    public playEffect(url: string, bundle: BUNDLE_TYPE, loop: boolean = false) {\n        return new Promise<number>((resolve) => {\n            if (CC_DEBUG) {\n                if (!this.owner) {\n                    cc.error(`必须要指定资源的管理都才能播放`);\n                    resolve(-1);\n                    return;\n                }\n            }\n            if (this.audioData.isEffectOn) {\n                Manager.cacheManager.getCacheByAsync(url, cc.AudioClip, bundle).then((data) => {\n                    if (this.audioData) {\n                        if (data) {\n                            let info = new ResourceInfo;\n                            info.url = url;\n                            info.type = cc.AudioClip;\n                            info.data = data;\n                            info.bundle = bundle;\n                            if (this.owner) {\n                                Manager.uiManager.addLocal(info, this.owner.className);\n                            } else {\n                                Manager.uiManager.garbage.addLocal(info);\n                            }\n\n                            this.audioData.curEffectId = cc.audioEngine.playEffect(data, loop);\n                        }\n\n                        this.effectMap.set(url, this.audioData.curEffectId);\n                        resolve(this.audioData.curEffectId);\n                    }\n\n                });\n            } else {\n                this.audioData.curEffectId = -1;\n                resolve(-1);\n            }\n        });\n    }\n\n    public onEnterBackground() {\n        cc.audioEngine.pauseMusic();\n        cc.audioEngine.pauseAllEffects();\n    }\n\n    public onEnterForgeground(inBackgroundTime: number) {\n        cc.audioEngine.resumeMusic();\n        cc.audioEngine.resumeAllEffects();\n    }\n\n}\n"]}