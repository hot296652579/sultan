{"version":3,"sources":["assets/script/minigame/MinigameView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import BindEmailView from \"../common/bindItemView/BindEmailView\";\nimport TitleItemPageUser from \"../common/item/TitleItemPageUser\";\nimport { i18n } from \"../common/language/LanguageImpl\";\nimport { Manager } from \"../common/manager/Manager\";\nimport { LobbyService } from \"../common/net/LobbyService\";\nimport NumberUtils from \"../common/utils/NumberUtils\";\nimport TypeUtils from \"../common/utils/TypeUtils\";\nimport UserData from \"../data/UserData\";\nimport { BUNDLE_RESOURCES, ENABLE_CHANGE_LANGUAGE } from \"../framework/base/Defines\";\nimport { IController } from \"../framework/controller/Controller\";\nimport { injectService } from \"../framework/decorator/Decorators\";\nimport { EventApi } from \"../framework/event/EventApi\";\nimport { MST } from \"../framework/external/protoc\";\nimport UIView from \"../framework/ui/UIView\";\nimport PanelHelp from \"../msgbox/PanelHelp\";\nimport { MinigameDefine } from \"./MinigameDefine\";\nimport MinigameGoldView from \"./MinigameGoldView\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\n@injectService(LobbyService.instance)\nexport default class MinigameView extends UIView implements IController<LobbyService>{\n    service: LobbyService;\n\n    @property(cc.SpriteFrame)\n    private spfFinish: cc.SpriteFrame = null;\n\n    @property(cc.SpriteFrame)\n    private spfUnFinish: cc.SpriteFrame = null;\n\n    @property(sp.Skeleton)\n    private spnAwardBox: sp.Skeleton = null;\n\n    @property([cc.Sprite])\n    private imgBoxShadow: cc.Button[] = [];\n\n    @property(cc.Label)\n    private labTaskTitle: cc.Label = null;\n\n    @property(cc.Node)\n    private nodTaskItem0: cc.Node = null;\n\n    @property(cc.Button)\n    private btnBindEmail: cc.Button = null;\n\n    @property(cc.Label)\n    private labBindEmail: cc.Label = null;\n\n    @property(cc.Node)\n    private nodTaskItem1: cc.Node = null;\n\n    @property(cc.Label)\n    private labBonusTitle: cc.Label = null;\n\n    @property(cc.Label)\n    private labBonusTips: cc.Label = null;\n\n    @property(cc.Label)\n    private labBonusGold: cc.Label = null;\n\n    @property(TitleItemPageUser)\n    private titleItemPageUser: TitleItemPageUser = null;\n\n    // 用户数据\n    private _userData: UserData = null;\n    // 小游戏信息\n    private _minigameInfo: MST.IS2C_MinigameInfo = null;\n    // 小游戏开奖结果\n    private _minigameLottery: MST.IS2C_MinigameLottery = null;\n\n    public static getPrefabUrl() {\n        return \"minigame/prefabs/MinigameView\";\n    }\n\n    onLoad() {\n        super.onLoad();\n\n        this.audioHelper.playMusic(MinigameDefine.BGM, this.bundle);\n\n        this.initData();\n        this.initUI();\n\n        this.C2S_MinigameInfo();\n    }\n\n    start() {\n\n    }\n\n    private initData(): void {\n        this._userData = G.DataMgr.get(UserData);\n        this._minigameInfo = null;\n        this._minigameLottery = null;\n    }\n\n    private initUI(): void {\n        this.spnAwardBox.node.active = false;\n        this.labTaskTitle.string = \"\";\n        this.labBonusTitle.string = \"\";\n        this.labBonusTips.string = \"\";\n        this.labBonusGold.string = \"\";\n        this.nodTaskItem0.getChildByName(\"imgIsFinish\").getComponent(cc.Sprite).spriteFrame = this.spfUnFinish;\n        this.nodTaskItem1.getChildByName(\"imgIsFinish\").getComponent(cc.Sprite).spriteFrame = this.spfUnFinish;\n        this.btnBindEmail.node.active = true;\n    }\n\n    protected bindingEvents(): void {\n        super.bindingEvents();\n\n        if (ENABLE_CHANGE_LANGUAGE) {\n            this.registerEvent(EventApi.CHANGE_LANGUAGE, this.onLanguageChange);\n        }\n\n        this.registerEvent(\"Event_S2C_MinigameInfo\", this.onEvent_S2C_MinigameInfo);\n        this.registerEvent(\"Event_S2C_MinigameLottery\", this.onEvent_S2C_MinigameLottery);\n        this.registerEvent(\"Event_S2C_BindEmail\", this.onEvent_S2C_BindEmail);\n        this.registerEvent(\"updateUserInfo\", this.onUpdateUserInfo)\n\n    }\n\n    private onLanguageChange(): void {\n        this.titleItemPageUser.languagePageName(Manager.makeLanguage(\"Minigame.labPageName\"));\n        this.labTaskTitle.language = Manager.makeLanguage(\"Minigame.labTaskTitle\");\n        this.nodTaskItem0.getChildByName(\"labTaskDesc\").getComponent(cc.Label).language = Manager.makeLanguage(\"Minigame.labTaskDesc0\");\n        this.labBindEmail.language = Manager.makeLanguage(\"Minigame.labBindEmail\");\n        this.nodTaskItem1.getChildByName(\"labTaskDesc\").getComponent(cc.Label).language = Manager.makeLanguage(\"Minigame.labTaskDesc1\");\n        this.labBonusTitle.language = Manager.makeLanguage(\"Minigame.labBonusTitle\");\n        this.labBonusTips.language = Manager.makeLanguage(\"Minigame.labBonusTips\");\n\n        if (this._minigameInfo && !TypeUtils.isNull(this._minigameInfo.todayBonus)) {\n            this.labBonusGold.language = Manager.makeLanguage([\"Minigame.RpGold\", NumberUtils.converToC(this._minigameInfo.todayBonus)]);\n        }\n    }\n\n    public show(args?: any[]): void {\n        super.show(args);\n\n        this.onLanguageChange();\n    }\n\n    private refreshTask(): void {\n        let spfIsBindEmail: cc.SpriteFrame = null;\n        if (this.isBindEmail()) {\n            spfIsBindEmail = this.spfFinish;\n            this.btnBindEmail.node.active = false;\n        } else {\n            spfIsBindEmail = this.spfUnFinish;\n            this.btnBindEmail.node.active = true;\n        }\n        this.nodTaskItem0.getChildByName(\"imgIsFinish\").getComponent(cc.Sprite).spriteFrame = spfIsBindEmail;\n\n        let spfIsFinish: cc.SpriteFrame = null;\n        if (this._minigameInfo.isFinishGame) {\n            spfIsFinish = this.spfFinish;\n        } else {\n            spfIsFinish = this.spfUnFinish;\n        }\n        this.nodTaskItem1.getChildByName(\"imgIsFinish\").getComponent(cc.Sprite).spriteFrame = spfIsFinish;\n    }\n\n    private refreshBonus(): void {\n        this.labBonusGold.language = Manager.makeLanguage([\"Minigame.RpGold\", NumberUtils.converToC(this._minigameInfo.todayBonus)]);\n    }\n\n    private playLotteryAnim(): void {\n        let btnAwardBox: cc.Button = this.imgBoxShadow[this._minigameLottery.boxIndex].node.getChildByName(\"btnAwardBox\").getComponent(cc.Button);\n        let awardBoxWorldPos: cc.Vec2 = btnAwardBox.node.convertToWorldSpaceAR(cc.v2(0, 0));\n        let spnAwardBoxPos: cc.Vec2 = this.spnAwardBox.node.parent.convertToNodeSpaceAR(awardBoxWorldPos)\n\n        btnAwardBox.node.active = false;\n        this.spnAwardBox.node.active = true;\n        this.spnAwardBox.node.position = cc.v2(spnAwardBoxPos.x, spnAwardBoxPos.y - 5.5);\n\n        let kaiAnim = this.spnAwardBox.setAnimation(0, \"kai\", false);\n        this.spnAwardBox.setTrackCompleteListener(kaiAnim, this.onAnimOpenBoxFinish.bind(this));\n    }\n\n    private clickBox(index: number): void {\n        if (!this.isBindEmail()) {\n            PanelHelp.showTip(i18n.Tips.PleaseBindYourEmail);\n            return;\n        }\n\n        if (!this._minigameInfo.isFinishGame) {\n            PanelHelp.showTip(i18n.Tips.CompleteAnyGameToGetIt);\n            return;\n        }\n\n        if (this._minigameInfo.isReceiveBonus) {\n            PanelHelp.showTip(i18n.Tips.BonusAlreadyReceived);\n            return;\n        }\n\n        this.C2S_MinigameLottery(index);\n    }\n\n    private clickBindEmail(): void {\n        Manager.uiManager.open({ type: BindEmailView, bundle: BUNDLE_RESOURCES });\n    }\n\n    public onClick(ButtonName: any, ButtonNode: any, data?: string): void {\n        switch (ButtonName) {\n            case \"btnAwardBox\":\n                this.clickBox(Number(data));\n                break;\n            case \"btnBindEmail\":\n                this.clickBindEmail();\n                break;\n            case \"btnClose\":\n                this.close();\n                break;\n        }\n    }\n\n    private onAnimOpenBoxFinish(entry: sp.spine.TrackEntry, loopCount: number): void {\n        let goldWorldPos: cc.Vec2 = this.titleItemPageUser.getGoldWorldPos();\n        let goldLocalPos: cc.Vec2 = this.node.convertToNodeSpaceAR(goldWorldPos);\n        Manager.uiManager.open({ type: MinigameGoldView, bundle: BUNDLE_RESOURCES, args: [this._minigameLottery.award, goldLocalPos] });\n        this.spnAwardBox.setAnimation(0, \"daiji\", true);\n    }\n\n    private isBindEmail(): boolean {\n        return !TypeUtils.isNull(this._userData.email) && this._userData.email.length > 0;\n    }\n\n    /**\n     * 请求小游戏开奖\n     * @param index {number} 盒子下标\n     */\n    private C2S_MinigameLottery(index: number): void {\n        let req = MST.C2S_MinigameLottery.create({\n            serial: Manager.netManager.getNewSeqId(),\n            boxIndex: index,\n        });\n        let buffer = MST.C2S_MinigameLottery.encode(req).finish();\n        LobbyService.instance.sendMsg(MST.C2S_MinigameLottery, MST.OuterOpcode_Lobby.C2S_MinigameLottery, buffer);\n    }\n\n    /**\n     * 请求小游戏信息\n     */\n    private C2S_MinigameInfo(): void {\n        let req = MST.C2S_MinigameInfo.create({\n            serial: Manager.netManager.getNewSeqId()\n        });\n        let buffer = MST.C2S_MinigameInfo.encode(req).finish();\n        LobbyService.instance.sendMsg(MST.C2S_MinigameInfo, MST.OuterOpcode_Lobby.C2S_MinigameInfo, buffer);\n    }\n\n    /**\n     * 响应小游戏信息\n     */\n    private onEvent_S2C_MinigameInfo(data: MST.IS2C_MinigameInfo): void {\n        this._minigameInfo = data;\n        this.refreshTask();\n        this.refreshBonus();\n    }\n\n    /**\n     * 响应小游戏开奖\n     * @param data {MST.IS2C_MinigameLottery} 数据\n     */\n    private onEvent_S2C_MinigameLottery(data: MST.IS2C_MinigameLottery): void {\n        this.audioHelper.playEffect(MinigameDefine.Sound.OPEN_BOX, this.bundle);\n        this._minigameInfo.isReceiveBonus = true;\n        this._minigameLottery = data;\n        this.playLotteryAnim();\n    }\n\n    /**\n     * 绑定邮箱响应\n     */\n    private onEvent_S2C_BindEmail(): void {\n        this.refreshTask();\n    }\n\n    /**\n     * 登陆成功响应\n     */\n    private onUpdateUserInfo(): void {\n        this.C2S_MinigameInfo();\n    }\n\n    onDestroy(): void {\n        super.onDestroy();\n        this.audioHelper.stopMusic();\n    }\n}\n"]}