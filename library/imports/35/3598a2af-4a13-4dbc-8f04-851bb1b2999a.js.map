{"version":3,"sources":["assets/script/rank/LeaderBoardView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\nimport ScroViewCtrl from \"../common/component/ScroViewCtrl\";\nimport ScroViewLogic from \"../common/component/ScroViewLogic\";\nimport { i18n } from \"../common/language/LanguageImpl\";\nimport { Manager } from \"../common/manager/Manager\";\nimport { protoPackage, serverType } from \"../common/net/CommonService\";\nimport { LobbyService } from \"../common/net/LobbyService\";\nimport { BUNDLE_RESOURCES } from \"../framework/base/Defines\";\nimport { IController } from \"../framework/controller/Controller\";\nimport { injectService, makeKey } from \"../framework/decorator/Decorators\";\nimport UIView from \"../framework/ui/UIView\";\nimport { User } from \"../global/User\";\nimport { UtilMgr } from \"../global/UtilMgr\";\nimport PanelHelp from \"../msgbox/PanelHelp\";\nimport RecordView from \"./RecordView\";\nimport RuleView from \"./RuleView\";\n\nconst { ccclass, property } = cc._decorator;\n\nexport enum rankType {\n    Friends = 1,  //好友\n    Wealth = 2,   //财富\n    DayEarn = 3,  //日赚\n}\n\n@ccclass\n@injectService(LobbyService.instance)\nexport default class LeaderBoardView extends UIView implements IController<LobbyService>{\n\n    @property(cc.ScrollView)\n    scrollView: cc.ScrollView = null;\n\n    @property(cc.Label)\n    myName: cc.Label = null;\n\n    @property(cc.Label)\n    myReward: cc.Label = null;\n\n    @property(cc.Label)\n    myRankIndex: cc.Label = null;\n\n    @property(cc.Label)\n    myGold: cc.Label = null;\n\n    @property(cc.Sprite)\n    myHead: cc.Sprite = null;\n\n    @property(cc.Node)\n    noResult: cc.Node = null;\n\n    @property(cc.Node)\n    redPoint: cc.Node = null;\n\n    _rankingList: any = []\n\n\n    service: LobbyService;\n\n    public static getPrefabUrl() {\n        return \"rank/prefabs/LeaderBoardView\";\n    }\n\n    onLoad() {\n        super.onLoad();\n        this.content = this.node.getChildByName('content');\n    }\n\n    bindingEvents() {\n        super.bindingEvents();\n        this.registerEvent(makeKey(serverType.Lobby, protoPackage.hall.HallCmd.CMD_NewRankingList), this.updateList);\n        this.registerEvent(makeKey(serverType.Lobby, protoPackage.hall.HallCmd.FLUSH_RED_DOT), this.flushRedDot);\n        this.registerEvent(\"updateUserInfo\", this.updateUserInfo);\n        this.registerEvent(\"OpenBox\", this.reqFlushRedDot);\n\n    }\n    updateUserInfo() {\n        this.myName.string = UtilMgr.setString(User._userName);\n        UtilMgr.loadHeadImg(this.myHead, User._headImgUrl, User._userID, this)\n    }\n    updateList(data) {\n        cc.log(data, \"Rank\")\n        if (data) {\n            if (data.statusMsg.status == 0) {\n                if (data.rankingPlayer.length > 0) {\n                    this._rankingList = data.rankingPlayer;\n                    this.getComponent(ScroViewLogic).initUI(this._rankingList)\n                    this.moveToMe();\n                    // this.rankView(data.rankingPlayer)\n                } \n                PanelHelp.hideLoading()\n                let meRankInfo = this.getMeRankInfo()\n                this.myRankIndex.string = meRankInfo.rankIndex ? meRankInfo.rankIndex : (data.winGold > 0 ? data.rankingSize + \"+\" : \"none\");\n                this.myReward.string = meRankInfo.reward ? UtilMgr.changeMoney(meRankInfo.reward) : \"none\";\n                this.myGold.string = meRankInfo.winChips ? UtilMgr.changeMoney(meRankInfo.winChips, true, true) : (data.winGold > 0 ? UtilMgr.changeMoney(data.winGold, true, true) : \"0\");\n                this.noResult.active = data.rankingPlayer.length == 0;\n            } else {\n                PanelHelp.showMsgBox('', Manager.makeLanguage(\"ERRORCODE.\" + data.statusMsg.status));\n            }\n        }\n    }\n\n    getMeRankInfo() {\n        let rankIndex = null;\n        let reward = null\n        let winChips = null\n        for (let i = 0; i < this._rankingList.length; i++) {\n            let rankInfo = this._rankingList[i]\n            if (rankInfo.userId == User._userID) {\n                rankIndex = rankInfo.rank;\n                reward = rankInfo.reward;\n                winChips = rankInfo.winGold;\n                break;\n            }\n        }\n        return { rankIndex, reward, winChips }\n    }\n\n    async rankView(rankingList) {\n        let scroViewCtrlCom = this.getComponent(ScroViewCtrl)\n        scroViewCtrlCom.dataList = rankingList\n        await scroViewCtrlCom.framingLoad(rankingList.length)\n        PanelHelp.hideLoading()\n        this.moveToMe();\n    }\n\n\n\n    show(args) {\n        super.show(args);\n        this.showWithAction(true);\n    }\n\n    onClick(name, node) {\n        switch (name) {\n            case \"close\": this.closeWithAction(); break;\n            case \"ruleBtn\": Manager.uiManager.open({ type: RuleView, bundle: BUNDLE_RESOURCES }); break;\n            case \"recordBtn\": Manager.uiManager.open({ type: RecordView, bundle: BUNDLE_RESOURCES }); break;\n            case \"backBtn\": this.moveToMe(); break;\n            default: G.Logger.error(\"no find button name -> %s\", name);\n        }\n    }\n\n    moveToMe() {\n        let myRank = this.getMeRankInfo().rankIndex;\n        let showLen = 6;//能显示的最多只有6条\n        let maxLen = this._rankingList.length;\n        let showPosY = 4;//要偏移的Item数\n        let offLen = maxLen - showLen;//能最多偏移的Item数\n        if (myRank) {//我存在 移动到我的位置\n            //自己名次占比 \n            if (maxLen < showLen) { //小于6位 直接滚动到顶层\n                this.scrollView.scrollToTop(0.2);\n            } else if ((myRank + showPosY - showLen) > maxLen) {// 我Item显示在中间 = 我的排名+ 需要偏移的Item - 不偏移的Item ,越界直接移动到底部\n                this.scrollView.scrollToBottom(0.2);\n            } else {\n                if (offLen <= 3) {\n                    if (myRank <= showPosY) { // 我是前四名 那么我不用偏移\n                        this.scrollView.scrollToTop(0.2);\n                    } else {//正常偏移\n                        let offY = myRank - showPosY;\n                        let offEnd = 1 - offY / offLen;\n                        this.scrollView.scrollTo(new cc.Vec2(0, offEnd), 0.2);\n                    }\n                } else {//正常偏移\n                    let offY = myRank - showPosY;\n                    let offEnd = 1 - offY / offLen;\n                    this.scrollView.scrollTo(new cc.Vec2(0, offEnd), 0.2);\n                }\n            }\n        } else {//移动到底部\n            this.scrollView.scrollToBottom(0.2);\n        }\n    }\n\n    refreshRank() {\n        this.service.sendMsg(serverType.Lobby,\n            protoPackage.hall.HallCmd.CMD_NewRankingList,\n            null);\n    }\n\n    start() {\n        this.myName.string = UtilMgr.setString(User._userName);\n        this.myGold.string = User.isRechargedPlayer ? \"0\" : i18n.EXPERIENCE_FIELD.NoGold;\n        UtilMgr.loadHeadImg(this.myHead, User._headImgUrl, User._userID, this)\n        PanelHelp.showLoading(i18n.WAIT.LOADING)\n        this.refreshRank()\n        this.reqFlushRedDot();\n    }\n\n\n    private flushRedDot(data) {\n        cc.log(data, \"rankRedPoint\")\n        if (data) {\n            if (data.statusMsg.status == 0) {\n                if (this.redPoint) {\n                    this.redPoint.active = data.rank && data.rank.redDot == 1;\n                }\n            } else {\n                PanelHelp.showMsgBox('', Manager.makeLanguage(\"ERRORCODE.\" + data.statusMsg.status));\n            }\n        }\n    }\n    reqFlushRedDot() {\n        let req = protoPackage.hall.base.FlushRedDot.create({ userId: User._userID });\n        let buffer = protoPackage.hall.base.FlushRedDot.encode(req).finish();\n        this.service.sendMsg(serverType.Lobby,\n            protoPackage.hall.HallCmd.FLUSH_RED_DOT,\n            buffer);\n    }\n\n    onDestroy() {\n        super.onDestroy();\n    }\n    // update (dt) {}\n}\n"]}