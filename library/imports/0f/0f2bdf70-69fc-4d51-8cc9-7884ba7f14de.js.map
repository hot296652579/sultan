{"version":3,"sources":["assets/script/turntable/TurntableView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\nimport { i18n } from \"../common/language/LanguageImpl\";\nimport { serverType, protoPackage } from \"../common/net/CommonService\";\nimport { LobbyService } from \"../common/net/LobbyService\";\nimport { BUNDLE_RESOURCES } from \"../framework/base/Defines\";\nimport { IController } from \"../framework/controller/Controller\";\nimport { injectService, makeKey } from \"../framework/decorator/Decorators\";\nimport { com } from \"../framework/external/protoc\";\nimport { Manager } from \"../common/manager/Manager\";\nimport UIView from \"../framework/ui/UIView\";\nimport { User } from \"../global/User\";\nimport PanelHelp from \"../msgbox/PanelHelp\";\nimport AwardWinningView from \"./AwardWinningView\";\nimport HelpView from \"./HelpView\";\nimport MyPrizeView from \"./MyPrizeView\";\nimport PrizeItem from \"./PrizeItem\";\nimport { UtilMgr } from \"../global/UtilMgr\";\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\n@injectService(LobbyService.instance)\nexport default class TurntableView extends UIView implements IController<LobbyService> {\n\n    service: LobbyService;\n\n    @property(cc.Label)\n    remainingTimes: cc.Label = null;\n\n    @property(cc.Node)\n    itemContent: cc.Node = null;\n\n    @property(cc.Node)\n    lightGround: cc.Node = null;\n\n    @property(cc.Prefab)\n    itemPrize: cc.Prefab = null;\n\n    @property(cc.Label)\n    awardTips: cc.Label = null;\n\n    public turnTableType: number;\n    private prizeData: com.bt.game.proto.hall.IActivityTurntable[];\n    private rule: string;\n    private movex: number = 0;\n    private isCheckSpin: boolean = false;\n    private activityTurntableData: com.bt.game.proto.hall.IActivityTurntableRes;\n    private currentTimes: number;\n\n    public static inst = null;\n    public static getPrefabUrl() {\n        return \"turntable/prefab/TurntableView\";\n    }\n    onLoad() {\n        super.onLoad();\n        this.content = this.node.getChildByName('content');\n        this.awardTips.string = '';\n        TurntableView.inst = this;\n    }\n\n    start() {\n        this.activityTurntableRes(this.activityTurntableData);\n        this.showLightAnimation();\n    }\n\n    show(args) {\n        super.show(args);\n        this.showWithAction(true);\n        if (args) {\n            this.activityTurntableData = args;\n            this.turnTableType = args.type;\n        }\n        G.Logger.log(\"args-----------------------\", args);\n    }\n\n\n    bindingEvents() {\n        super.bindingEvents();\n        this.registerEvent(makeKey(serverType.Lobby, protoPackage.hall.HallCmd.Play_Turntable), this.playTurntableRes);\n    }\n\n    onClick(name, node) {\n        switch (name) {\n            case \"close\":\n                if (this.itemContent.getNumberOfRunningActions() > 0) return;\n                UtilMgr.popWindows(\"OpenTurntable\");\n                this.closeWithAction();\n                break;\n            case \"btn_bangzhu\": Manager.uiManager.open({ type: HelpView, bundle: BUNDLE_RESOURCES, args: [this.rule] }); break;\n            case \"btn_myprize\":\n                if (this.isCheckSpin) return;\n                Manager.uiManager.open({ type: MyPrizeView, bundle: BUNDLE_RESOURCES ,args:[this.turnTableType]});\n                break;\n            case \"btn_spin\": this.reqPlayTurntable(); break;\n            default: G.Logger.error(\"no find button name -> %s\", name);\n        }\n    }\n\n\n\n    private activityTurntableRes(msg): void {\n        if (msg.statusMsg.status == 0) {\n            this.remainingTimes.string = msg.remainingTimes;\n            this.currentTimes = msg.remainingTimes;\n            this.rule = msg.rule;\n            if(msg.rotations.length > 0)this.updateAwardTips(msg.rotations);\n            this.drawTurntable(msg.activeTurntable);\n        } else {\n            PanelHelp.showTip(i18n.ERRORCODE[msg.statusMsg.status]);\n        }\n\n    }\n\n    private drawTurntable(data: com.bt.game.proto.hall.IActivityTurntable[]) {\n        this.prizeData = data;\n        this.itemContent.removeAllChildren();\n        for (let i = 0; i < data.length; i++) {\n            let item = cc.instantiate(this.itemPrize);\n            item.parent = this.itemContent;\n            item.getComponent(PrizeItem).updateItem(data[i]);\n        }\n    }\n\n    private reqPlayTurntable() {\n        if (this.isCheckSpin) return;\n        this.isCheckSpin = true;\n        let req = protoPackage.hall.PlayTurntableReq.create({ type: this.turnTableType });//转盘类型 1签到转盘 2充值转盘\n        let buffer = protoPackage.hall.PlayTurntableReq.encode(req).finish();\n        this.service.sendMsg(serverType.Lobby,\n            protoPackage.hall.HallCmd.Play_Turntable,\n            buffer);\n    }\n\n    private playTurntableRes(data: com.bt.game.proto.hall.IPlayTurntableRes) {\n        if (data.statusMsg.status == 0) {\n            this.runTurnTable(data);\n        } else {\n            this.isCheckSpin = false;\n            PanelHelp.showTip(i18n.ERRORCODE[data.statusMsg.status]);\n        }\n\n    }\n\n    runTurnTable(data: com.bt.game.proto.hall.IPlayTurntableRes) {\n        let tableId = data.tableId - 1;\n        let delay = 2;//先转两圈\n        let delay1 = 4//回弹\n        let startMoveRotate = 1080;\n        let offsetR = this.itemContent.angle % 360;\n        this.itemContent.angle = offsetR;//当前item偏差度数;\n        let rotate = tableId * 360 * 0.1 + startMoveRotate * 2;\n        Manager.globalAudio.playEffect(\"turntable/audio/rotate\", BUNDLE_RESOURCES);\n        this.remainingTimes.string = (this.currentTimes - 1) >= 0 ? (this.currentTimes - 1).toString() : \"0\";\n        cc.tween(this.itemContent)\n            .to(delay, { angle: -startMoveRotate }, { easing: 'sineIn' })\n            .to(delay1, { angle: -rotate }, { easing: 'quadOut' })\n            .delay(0.2).call(() => {\n                let prizeData = this.prizeData.find(pdata => { return pdata.tableId == data.tableId });\n                this.remainingTimes.string = data.remainingTimes >= 0 ? data.remainingTimes.toString() : \"0\";\n                this.currentTimes = data.remainingTimes;\n                Manager.globalAudio.playEffect(\"turntable/audio/win\", BUNDLE_RESOURCES);\n                Manager.uiManager.open({ type: AwardWinningView, bundle: BUNDLE_RESOURCES, args: [data, prizeData] });\n            }).delay(0.5).call(()=>{\n                //转盘启动按钮是否可以点击  延迟0.5s 防止弹出奖励界面的时候 再次旋转\n                this.isCheckSpin = false;\n            })\n            .start();\n    }\n\n    updateAwardTips(tipRotations: com.bt.game.proto.hall.IRotation[]) {\n        let nodeWidth = 300;//显示区域宽\n        let speed = 50;\n        let tipsLen = tipRotations.length;\n        let rand = UtilMgr.random(0, tipsLen);\n        let arr1 = tipRotations.splice(rand);\n        let endTips = arr1.concat(tipRotations);\n        let startTip = 0;\n        this.movex = nodeWidth * 0.5 + (this.awardTips.node.width > nodeWidth ? this.awardTips.node.width : nodeWidth);\n        this.awardTips.string = endTips[startTip].username + \" Won \" + endTips[startTip].goodsName;\n        let time = Math.floor(this.movex / speed)\n        this.awardTips.node.x = this.movex;\n        G.Logger.log(\"endTips\", endTips);\n\n\n        let changeTips = () => {\n            startTip += 1;\n            if (startTip > tipsLen - 1) {\n                startTip = 0;\n            }\n            let x = this.awardTips.node.width * 0.5 + nodeWidth * 0.5;\n            if (this.awardTips.node.x >= x || this.awardTips.node.x <= -x) {\n                this.awardTips.string = endTips[startTip].username + \" Won \" + endTips[startTip].goodsName;\n                this.movex = nodeWidth * 0.5 + (this.awardTips.node.width > nodeWidth ? this.awardTips.node.width : nodeWidth);\n            }\n        }\n\n        cc.tween(this.awardTips.node)\n            .repeatForever(cc.tween().to(time, { position: cc.v2(-this.movex, 0) })\n                .call(() => {\n                    this.awardTips.node.x = this.movex;\n                    changeTips();\n                })).start()\n\n        //改了 不用间隔十秒滚动\n        // this.schedule(changeTips, 10);\n    }\n    showLightAnimation() {\n        if (this.lightGround && this.lightGround.children[0]) {\n            let light = this.lightGround.children[0];\n            this.lightGround.removeAllChildren();\n            for (let i = 0; i < 24; i++) {\n                let lightItem = cc.instantiate(light);\n                lightItem.parent = this.lightGround;\n                lightItem.angle = -15 * i;\n            }\n            this.lightGround.children.forEach((lt, i) => {\n                if (i % 4 == 0) {\n                    lt.runAction(cc.repeatForever(cc.sequence(cc.fadeIn(0.8), cc.fadeOut(0.8), cc.delayTime(4.8))));\n                } else if (i % 4 == 1) {\n                    lt.runAction(cc.repeatForever(cc.sequence(cc.delayTime(1.6), cc.fadeIn(0.8), cc.fadeOut(0.8), cc.delayTime(3.2))));\n                } else if (i % 4 == 2) {\n                    lt.runAction(cc.repeatForever(cc.sequence(cc.delayTime(3.2), cc.fadeIn(0.8), cc.fadeOut(0.8), cc.delayTime(1.6))));\n                } else if (i % 4 == 3) {\n                    lt.runAction(cc.repeatForever(cc.sequence(cc.delayTime(4.8), cc.fadeIn(0.8), cc.fadeOut(0.8))));\n                }\n            });\n        }\n\n    }\n    onDestroy() {\n        // this.unscheduleAllCallbacks();\n        this.turnTableType = 0;\n        TurntableView.inst = null;\n        super.onDestroy();\n    }\n}\n"]}