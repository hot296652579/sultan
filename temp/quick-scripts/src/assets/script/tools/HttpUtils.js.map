{"version":3,"sources":["assets/script/tools/HttpUtils.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["/**\n * Http 请求封装\n */\nexport default class HttpUtils {\n    protected static _instance: HttpUtils = null;\n    public static get instance() { return this._instance || (this._instance = new HttpUtils()); }\n    constructor() {\n\n    }\n\n    /**\n     * get请求\n     * @param {string} url \n     * @param {function} callback \n     */\n    httpGet(url, callback) {\n        let xhr = cc.loader.getXMLHttpRequest();\n        xhr.onreadystatechange = function () {\n            // cc.log(\"Get: readyState:\" + xhr.readyState + \" status:\" + xhr.status);\n            if (xhr.readyState === 4 && xhr.status == 200) {\n                let respone = xhr.responseText;\n                let rsp = JSON.parse(respone);\n                callback(rsp);\n            } else if (xhr.readyState === 4 && xhr.status == 401) {\n                callback({ status: 401 });\n            } else {\n                //callback(-1);\n            }\n        };\n        xhr.withCredentials = true;\n        xhr.open('GET', url, true);\n\n        // if (cc.sys.isNative) {\n        xhr.setRequestHeader('Access-Control-Allow-Origin', '*');\n        xhr.setRequestHeader('Access-Control-Allow-Methods', 'GET, POST');\n        xhr.setRequestHeader('Access-Control-Allow-Headers', 'x-requested-with,content-type,authorization');\n        xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n        // xhr.setRequestHeader('Authorization', 'Bearer ' + \"\");\n        // }\n\n        // note: In Internet Explorer, the timeout property may be set only after calling the open()\n        // method and before calling the send() method.\n        xhr.timeout = 8000;// 8 seconds for timeout\n\n        xhr.send();\n    }\n\n    /**\n     * post请求\n     * @param {string} url \n     * @param {object} params \n     * @param {function} callback \n     */\n    httpPost(url, params, callback) {\n        let xhr = cc.loader.getXMLHttpRequest();\n        xhr.onreadystatechange = function () {\n            // cc.log('xhr.readyState=' + xhr.readyState + '  xhr.status=' + xhr.status);\n            if (xhr.readyState === 4 && xhr.status == 200) {\n                let respone = xhr.responseText;\n                let rsp = JSON.parse(respone);\n\n                callback(rsp);\n            } else {\n                callback(-1);\n            }\n        };\n        xhr.open('POST', url, true);\n        // if (cc.sys.isNative) {\n        xhr.setRequestHeader('Access-Control-Allow-Origin', '*');\n        xhr.setRequestHeader('Access-Control-Allow-Methods', 'GET, POST');\n        xhr.setRequestHeader('Access-Control-Allow-Headers', 'x-requested-with,content-type');\n        xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n        // }\n\n        // note: In Internet Explorer, the timeout property may be set only after calling the open()\n        // method and before calling the send() method.\n        xhr.timeout = 8000;// 8 seconds for timeout\n\n        xhr.send(JSON.stringify(params));\n    }\n}"]}